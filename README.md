# 🏛️ מערכת CRM לניהול נוכחות כוללים

[![Deploy to Render](https://render.com/images/deploy-to-render-button.svg)](https://render.com/deploy)

מערכת מתקדמת וחדשנית לניהול נוכחות ומלגות אברכים בכוללי תורה. המערכת כוללת מעקב מפורט אחר שעות הגעה ויציאה, חישוב אוטומטי של מלגות על בסיס חוקים מוגדרים מראש, וניהול מתקדם של בונוסים וקיזוזים.

## 🌟 תכונות עיקריות

### 👥 ניהול אברכים מתקדם
- רישום פרטי אברכים מלא עם validation חכם
- שיוך גמיש לסניפים ופרופילי תשלום
- מעקב אחר סטטוס פעילות ותאריכי התחלה

### 📅 מערכת נוכחות חכמה
- רישום יומי של שעות כניסה ויציאה
- חישוב אוטומטי של איחורים ויציאות מוקדמות
- תמיכה בבונוסים יומיים (כגון תענית דיבור)
- הזנה קלה וידידותית למשתמש

### 💰 מערכת תשלומים מתקדמת וגמישה
- **פרופילי תשלום מותאמים אישית** - כל כולל יכול להגדיר חוקים משלו
- **תמיכה בשתי שיטות תשלום:**
  - תשלום יומי קבוע (₪X ליום)
  - יעד חודשי מחולק לימים (₪X לחודש)
- **מערכת קיזוזים מתקדמת:**
  - קיזוז על איחורים (קבוע או לפי דקה)
  - קיזוז על יציאות מוקדמות
  - קיזוז על היעדרויות
- **מערכת בונוסים חכמה:**
  - בונוסים יומיים (תענית דיבור, הישגים מיוחדים)
  - בונוסים מבוססי רצף (עידוד להתמדה)
  - חוקי שבירת רצף מותאמים

### 📊 דוחות ובקרה מפורטים
- **דשבורד ראשי** עם סטטיסטיקות בזמן אמת
- **דוחות תשלומים חודשיים** מפורטים
- **ייצוא נתונים** לExcel/CSV למערכות חשבונות
- **מעקב אישי** לכל אברך

### 🗓️ לוח שנה מערכתי חכם
- הגדרת ימי עבודה וחגים
- התאמה לפי מנהג כל כולל
- ימים מיוחדים עם תעריפים שונים

### 🔐 אבטחה והרשאות מתקדמות
- מערכת משתמשים עם רמות הרשאה מדורגות
- הרשאות מנהל וחוקר נפרדות
- אבטחת נתונים ברמה גבוהה

## 🛠️ טכנולוגיות מתקדמות

- **Backend:** Python Flask + SQLAlchemy ORM
- **Frontend:** Bootstrap 5 RTL + JavaScript ES6+
- **Database:** SQLite לפיתוח, PostgreSQL לייצור
- **Deployment:** מוכן לפריסה בRender, Heroku, או כל פלטפורמת ענן
- **Security:** הצפנת סיסמאות, הגנת CSRF, ועוד

## התקנה מהירה

1. **שכפול הפרויקט:**
```bash
git clone <repository-url>
cd CRM_KOLEL
```

2. **יצירת סביבת עבודה וירטואלית:**
```bash
python -m venv venv
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate
```

3. **התקנת התלויות:**
```bash
pip install -r requirements.txt
```

4. **הגדרת משתני סביבה (אופציונלי):**
צור קובץ `.env` בתיקיית הפרויקט:
```
SECRET_KEY=your-secret-key-here
DATABASE_URL=sqlite:///kolel_crm.db
```

5. **אתחול בסיס הנתונים:**
```bash
python run.py init-db
```

6. **הפעלת השרת:**
```bash
python run.py
```

השרת יעלה בכתובת: `http://localhost:5000`

## פרטי התחברות ראשונים

**מנהל מערכת:**
- שם משתמש: `admin`
- סיסמה: `admin123`

⚠️ **חשוב:** שנה את הסיסמה לאחר ההתחברות הראשונה!

## מבנה הפרויקט

```
CRM_KOLEL/
├── app/
│   ├── __init__.py           # התחלת האפליקציה
│   ├── models.py             # מודלי בסיס הנתונים
│   ├── auth/                 # מודול הזדהות
│   ├── main/                 # דשבורד ראשי
│   ├── avrech/               # ניהול אברכים
│   ├── attendance/           # ניהול נוכחות
│   ├── payment_profiles/     # פרופילי תשלום
│   ├── calendar/             # לוח שנה מערכתי
│   ├── reports/              # דוחות
│   ├── admin/                # ניהול מערכת
│   ├── templates/            # תבניות HTML
│   └── static/               # קבצים סטטיים
├── requirements.txt          # תלויות Python
└── run.py                   # הפעלת השרת
```

## מדריך שימוש מהיר

### הוספת אברך חדש
1. היכנס לתפריט "אברכים" → "הוסף אברך"
2. מלא את הפרטים הנדרשים
3. בחר סניף ופרופיל תשלום
4. שמור

### רישום נוכחות יומי
1. היכנס ל"נוכחות" → "רישום יומי"
2. בחר תאריך (ברירת מחדל: היום)
3. הזן שעות כניסה ויציאה
4. סמן בונוסים במידת הצורך
5. המערכת תחשב אוטומטית איחורים וסכומים

### יצירת פרופיל תשלום
1. היכנס ל"הגדרות" → "פרופילי תשלום" (דרושות הרשאות מנהל)
2. לחץ "הוסף פרופיל חדש"
3. הגדר שעות עבודה בסיסיות
4. בחר שיטת תשלום (יומי קבוע או יעד חודשי)
5. הגדר חוקי קיזוז ובונוסים
6. שמור

### הפקת דוח תשלומים
1. היכנס ל"דוחות"
2. בחר חודש ושנה
3. סנן לפי סניף במידת הצורך
4. ייצא לאקסל או הדפס

## פריסה בענן (Render)

הפרויקט מוכן לפריסה בפלטפורמת Render:

1. צור חשבון ב-[Render](https://render.com)
2. חבר את הריפו מ-GitHub
3. בחר "Web Service"
4. הגדר את הפקודות:
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `python run.py`
5. הגדר משתני סביבה במידת הצורך
6. פרוס

## רישיון

פרויקט זה פותח במיוחד לשימוש בכוללי תורה ומוגש בתור קוד פתוח.

## תמיכה

לשאלות ותמיכה, צור קשר או פתח Issue בגיטהאב.

---

**פותח בשפת Python עם Flask | עיצוב מודרני עם Bootstrap 5 | תמיכה מלאה בעברית**