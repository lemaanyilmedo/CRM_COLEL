@import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&family=Assistant:wght@300;400;500;600&display=swap');

/* ========================================
   CRM Kolel - Modern Executive Theme
   Clean · Minimal · Data Forward · RTL Friendly
   ======================================== */

:root {
    /* Brand Palette */
    --brand-950: #131621;
    --brand-900: #181d2b;
    --brand-800: #20273a;
    --brand-700: #2c354c;
    --brand-600: #3a4661;
    --brand-500: #4e5b7a;
    --brand-400: #657492;
    --brand-300: #8a96b1;
    --brand-200: #b8c0d4;
    --brand-100: #e6e8f0;

    /* Neutrals */
    --surface-25: #f7f8fb;
    --surface-50: #f1f2f6;
    --surface-100: #e6e8ee;
    --surface-200: #d7dae3;
    --surface-300: #c3c7d3;
    --surface-400: #a4a9b7;
    --surface-500: #878d9d;
    --surface-600: #6e7485;
    --surface-700: #5a6072;
    --surface-800: #464b5c;
    --surface-900: #323644;

    /* Semantic Colors */
    --success-500: #128c62;
    --warning-500: #d28b19;
    --danger-500: #d14b4b;
    --info-500: #4a65c3;

    /* Text */
    --text-strong: #151826;
    --text-primary: #23283a;
    --text-neutral: #4c5364;
    --text-muted: #6e7688;
    --text-subtle: #9097a6;
    --text-on-dark: #f4f5f9;

    /* Shadows & Radii */
    --shadow-xs: 0 1px 2px rgba(15, 23, 42, 0.08);
    --shadow-sm: 0 6px 16px -14px rgba(19, 22, 33, 0.35);
    --shadow-md: 0 18px 36px -24px rgba(19, 22, 33, 0.35);
    --shadow-lg: 0 28px 52px -28px rgba(19, 22, 33, 0.42);
    --radius-sm: 8px;
    --radius-md: 14px;
    --radius-lg: 20px;
    --radius-pill: 999px;

    /* Spacing Scale */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.5rem;
    --space-6: 2rem;
    --space-7: 2.5rem;
    --space-8: 3rem;

    /* Typography */
    --font-base: 'Rubik', 'Assistant', 'Segoe UI', Arial, sans-serif;
    --font-alt: 'Assistant', 'Rubik', 'Segoe UI', Arial, sans-serif;
    --font-size-base: 16px;
    --line-height-base: 1.6;

    /* Motion */
    --transition-base: 220ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-fast: 160ms cubic-bezier(0.4, 0, 0.2, 1);
}

@media (prefers-color-scheme: dark) {
    :root {
        --surface-25: #0f172a;
        --surface-50: #111b2d;
        --surface-100: #142035;
        --surface-200: #192840;
        --surface-300: #1f314c;
        --surface-400: #293c59;
        --surface-500: #354966;
        --surface-600: #475c7a;
        --surface-700: #5f7191;
        --surface-800: #7b8aa8;
        --surface-900: #95a4c0;
        --text-strong: #f9fafb;
        --text-primary: #f3f4f6;
        --text-neutral: #cbd5f5;
        --text-muted: #94a3b8;
        --text-subtle: #7c8aa5;
        --text-on-dark: #0b1120;
        --shadow-sm: 0 12px 30px -18px rgba(8, 145, 178, 0.35);
    }
}

*, *::before, *::after {
    box-sizing: border-box;
}

html {
    font-size: var(--font-size-base);
    height: 100%;
    scroll-behavior: smooth;
}

body {
    min-height: 100vh;
    font-family: var(--font-base);
    background: var(--surface-25);
    color: var(--text-primary);
    line-height: var(--line-height-base);
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    direction: rtl;
    text-align: right;
    margin: 0;
}

img, svg {
    display: block;
    max-width: 100%;
}

a {
    color: inherit;
    text-decoration: none;
    transition: color var(--transition-fast);
}

a:hover {
    color: var(--brand-500);
}

h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-alt);
    font-weight: 600;
    color: var(--text-strong);
    margin-bottom: var(--space-3);
}

h1 { font-size: clamp(2.1rem, 4vw, 3rem); }
h2 { font-size: clamp(1.75rem, 3vw, 2.25rem); }
h3 { font-size: clamp(1.45rem, 2.5vw, 1.85rem); }
h4 { font-size: 1.35rem; }
h5 { font-size: 1.15rem; }
h6 { font-size: 1rem; letter-spacing: 0.015em; }

p {
    margin-bottom: var(--space-3);
    color: var(--text-neutral);
}

small, .small {
    font-size: 0.875rem;
    color: var(--text-muted);
}

/* Layout Shell */
body.sidebar-layout {
    display: grid;
    grid-template-columns: 300px minmax(0, 1fr);
    min-height: 100vh;
    background: linear-gradient(120deg, rgba(58, 70, 97, 0.05), transparent 45%);
}

body.sidebar-layout .sidebar {
    grid-column: 1;
    grid-row: 1;
}

body.sidebar-layout .app-shell {
    grid-column: 2;
    grid-row: 1;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    background: var(--surface-25);
}

body.sidebar-layout .flash-container {
    padding-inline: var(--space-6);
}

.main-content {
    flex: 1;
    min-height: 0;
    background: var(--surface-25);
    padding: var(--space-6) var(--space-6) var(--space-7);
    overflow: visible;
}

footer.footer {
    margin-top: auto;
}

@media (max-width: 1100px) {
    body.sidebar-layout {
        display: block;
    }

    body.sidebar-layout .app-shell {
        min-height: 100vh;
    }
}

@media (max-width: 991px) {
    .main-content {
        padding: var(--space-5) var(--space-4) var(--space-6);
    }
}

.container-fluid {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0;
}

.section-title {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.section-title__meta {
    color: var(--text-muted);
    font-size: 0.95rem;
}

/* Sidebar */
.sidebar {
    position: sticky;
    top: 0;
    height: 100vh;
    background: radial-gradient(circle at top left, rgba(101, 116, 146, 0.15), transparent 48%), linear-gradient(180deg, var(--brand-900), var(--brand-800));
    color: var(--text-on-dark);
    padding: var(--space-5) var(--space-4);
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    box-shadow: var(--shadow-sm);
    z-index: 1020;
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-2);
}

.sidebar-brand {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-weight: 600;
    font-size: 1.2rem;
}

.sidebar-brand i {
    background: rgba(255, 255, 255, 0.1);
    padding: var(--space-2);
    border-radius: var(--radius-sm);
}

.sidebar-toggle {
    display: none;
}

.sidebar-search .form-control {
    background: rgba(15, 23, 42, 0.45);
    border: 1px solid rgba(148, 163, 184, 0.2);
    border-radius: var(--radius-md);
    padding: 0.65rem 0.85rem;
    color: var(--text-on-dark);
    transition: border var(--transition-fast), background var(--transition-fast);
}

.sidebar-search .form-control::placeholder {
    color: rgba(226, 232, 240, 0.6);
}

.sidebar-search .form-control:focus {
    outline: none;
    border-color: rgba(68, 192, 255, 0.65);
    box-shadow: 0 0 0 3px rgba(68, 192, 255, 0.15);
}

.sidebar-nav {
    flex: 1;
    overflow-y: auto;
    padding-inline: var(--space-1);
    scrollbar-width: none;
    overscroll-behavior: contain;
}

.sidebar-nav::-webkit-scrollbar {
    width: 0;
    height: 0;
}

.sidebar-nav .nav-item + .nav-item {
    margin-top: var(--space-1);
}

.sidebar-nav .nav-link {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: 0.85rem var(--space-3);
    color: rgba(230, 232, 240, 0.82);
    border-radius: var(--radius-md);
    font-weight: 500;
    transition: background var(--transition-fast), transform var(--transition-fast), color var(--transition-fast);
}

.sidebar-nav .nav-link i {
    background: rgba(15, 23, 42, 0.4);
    padding: 0.5rem;
    border-radius: var(--radius-sm);
    min-width: 2.25rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.sidebar-nav .nav-link:hover {
    background: rgba(101, 116, 146, 0.22);
    color: #fff;
    transform: translateX(-4px);
}

.sidebar-nav .nav-link.active {
    background: linear-gradient(120deg, rgba(101, 116, 146, 0.35), rgba(74, 86, 122, 0.28));
    color: #fff;
    box-shadow: inset 0 0 0 1px rgba(101, 116, 146, 0.35);
}

.sidebar-nav .nav-link .submenu-arrow {
    margin-right: auto;
    color: rgba(255, 255, 255, 0.6);
    transition: transform var(--transition-fast);
}

.nav-link[aria-expanded="true"] .submenu-arrow {
    transform: rotate(180deg);
}

.submenu {
    margin-top: var(--space-1);
    background: rgba(27, 31, 44, 0.38);
    border-radius: var(--radius-md);
    padding: var(--space-2) var(--space-2) var(--space-2) var(--space-4);
}

.submenu-link {
    display: block;
    padding: 0.6rem var(--space-2);
    border-radius: var(--radius-sm);
    color: rgba(226, 232, 240, 0.75) !important;
    font-size: 0.92rem;
}

.submenu-link:hover {
    background: rgba(101, 116, 146, 0.25) !important;
    color: #fff !important;
}

.sidebar-footer {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding-top: var(--space-3);
    border-top: 1px solid rgba(148, 163, 184, 0.15);
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.14);
    display: grid;
    place-items: center;
    font-size: 1.4rem;
    color: #fff;
}

.user-details {
    min-width: 0;
}

.user-name {
    color: #fff;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.user-role {
    color: rgba(226, 232, 240, 0.7);
    font-size: 0.82rem;
}

.user-actions .btn {
    color: rgba(226, 232, 240, 0.7);
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
}

.user-actions .btn:hover {
    background: rgba(101, 116, 146, 0.2);
    color: #fff;
}

@media (max-width: 1100px) {
    .sidebar {
        position: fixed;
        inset: 0 0 auto 0;
        width: min(320px, 90vw);
        transform: translateX(110%);
        transition: transform var(--transition-base);
    }

    .sidebar.show {
        transform: translateX(0);
    }

    .sidebar-overlay {
        position: fixed;
        inset: 0;
        background: rgba(15, 23, 42, 0.45);
        backdrop-filter: blur(4px);
        opacity: 0;
        pointer-events: none;
        transition: opacity var(--transition-base);
    }

    .sidebar-overlay.show {
        opacity: 1;
        pointer-events: auto;
    }

    .topbar {
        display: flex !important;
    }
}

.topbar {
    display: none;
    align-items: center;
    justify-content: space-between;
    padding: 0 var(--space-4);
    height: 64px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(15, 23, 42, 0.06);
    position: sticky;
    top: 0;
    z-index: 1010;
}

.topbar-toggle {
    font-size: 1.4rem;
    color: var(--brand-600);
}

.topbar-brand {
    font-weight: 600;
    color: var(--brand-700);
}

/* Cards */
.card {
    background: #fff;
    border-radius: var(--radius-lg);
    padding: var(--space-5);
    border: 1px solid rgba(19, 22, 33, 0.05);
    box-shadow: var(--shadow-xs);
    transition: transform var(--transition-base), box-shadow var(--transition-base), border-color var(--transition-fast);
}

.card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
    border-color: rgba(63, 74, 97, 0.22);
}

.card + .card {
    margin-top: var(--space-4);
}

.card-header {
    background: transparent;
    border: none;
    padding: 0 0 var(--space-4);
}

.card-header .title {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-strong);
}

.card-subtitle {
    color: var(--text-muted);
    font-size: 0.92rem;
}

.card-body {
    padding: 0;
}

.card-footer {
    margin-top: var(--space-4);
    padding-top: var(--space-4);
    border-top: 1px solid rgba(15, 23, 42, 0.06);
}

/* Stats */
.stats-grid {
    display: grid;
    gap: var(--space-4);
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.stats-card {
    padding: var(--space-4);
    border-radius: var(--radius-lg);
    background: linear-gradient(145deg, rgba(74, 86, 122, 0.12), rgba(190, 197, 214, 0.18));
    border: 1px solid rgba(90, 98, 123, 0.22);
    box-shadow: var(--shadow-xs);
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.stats-card__icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-md);
    background: rgba(76, 88, 119, 0.18);
    color: var(--brand-600);
    display: grid;
    place-items: center;
    font-size: 1.4rem;
}

.stats-card__value {
    font-size: 2rem;
    font-weight: 600;
    color: var(--text-strong);
}

.stats-card__label {
    color: var(--text-muted);
    font-size: 0.95rem;
}

.stats-card__delta {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.85rem;
    border-radius: var(--radius-pill);
    padding: 0.35rem 0.65rem;
    background: rgba(18, 140, 98, 0.14);
    color: #126f52;
}

/* Buttons */
.btn {
    border-radius: var(--radius-md) !important;
    font-weight: 500 !important;
    border: 1px solid transparent !important;
    padding: 0.65rem 1.35rem !important;
    transition: all var(--transition-fast) !important;
}

.btn-primary {
    background: linear-gradient(125deg, var(--brand-600), var(--brand-500)) !important;
    border-color: rgba(74, 86, 122, 0.35) !important;
    color: #fff !important;
    box-shadow: 0 14px 30px -20px rgba(58, 70, 97, 0.7);
}

.btn-primary:hover {
    filter: brightness(1.03);
    transform: translateY(-2px);
}

.btn-neutral {
    background: rgba(19, 22, 33, 0.05) !important;
    color: var(--text-primary) !important;
    border-color: rgba(19, 22, 33, 0.08) !important;
}

.btn-neutral:hover {
    border-color: rgba(74, 86, 122, 0.3) !important;
    color: var(--brand-600) !important;
}

.btn-outline-primary {
    background: transparent !important;
    color: var(--brand-600) !important;
    border-color: rgba(74, 86, 122, 0.45) !important;
}

.btn-outline-primary:hover {
    background: rgba(90, 102, 133, 0.12) !important;
    color: var(--brand-600) !important;
}

.btn-ghost {
    background: transparent !important;
    color: var(--text-neutral) !important;
}

.btn-ghost:hover {
    color: var(--brand-600) !important;
    background: rgba(74, 86, 122, 0.08) !important;
}

.btn-danger {
    background: linear-gradient(125deg, #c53b3b, #e46f4f) !important;
    border-color: rgba(197, 59, 59, 0.38) !important;
}

.btn-link {
    color: var(--brand-500);
    font-weight: 500;
}

.btn-link:hover {
    color: var(--brand-600);
}

.btn .loading-spinner {
    width: 1.1rem;
    height: 1.1rem;
    border-width: 2px;
}

/* Form Elements */
.form-label {
    font-weight: 500;
    color: var(--text-neutral);
    margin-bottom: var(--space-2);
}

.form-control,
.form-select {
    border-radius: var(--radius-md);
    border: 1px solid rgba(15, 23, 42, 0.08);
    background: rgba(255, 255, 255, 0.95);
    padding: 0.68rem 0.9rem;
    color: var(--text-primary);
    transition: border var(--transition-fast), box-shadow var(--transition-fast);
}

.form-control::placeholder {
    color: var(--text-subtle);
}

.form-control:focus,
.form-select:focus {
    border-color: rgba(28, 167, 236, 0.5);
    box-shadow: 0 0 0 4px rgba(28, 167, 236, 0.15);
}

.form-control.is-invalid,
.form-select.is-invalid {
    border-color: rgba(239, 68, 68, 0.6);
    box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.12);
}

input[type="checkbox"],
input[type="radio"] {
    accent-color: var(--brand-500);
}

/* Tables */
.table-container {
    border-radius: var(--radius-lg);
    border: 1px solid rgba(19, 22, 33, 0.08);
    box-shadow: var(--shadow-xs);
    overflow: hidden;
    background: #fff;
}

.table-header {
    padding: var(--space-4) var(--space-5);
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid rgba(19, 22, 33, 0.06);
}

.table-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-strong);
}

.table-actions {
    display: flex;
    gap: var(--space-2);
    flex-wrap: wrap;
}

.table {
    margin: 0;
    border-collapse: separate;
    border-spacing: 0;
}

.table thead th {
    background: var(--surface-50);
    color: var(--text-neutral);
    font-weight: 600;
    padding: 0.9rem var(--space-5);
    border-bottom: 1px solid rgba(15, 23, 42, 0.06);
    position: relative;
}

.table tbody td {
    padding: 0.95rem var(--space-5);
    border-bottom: 1px solid rgba(26, 31, 45, 0.04);
    color: var(--text-primary);
}

.table-hover tbody tr {
    transition: background var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast);
}

.table-hover tbody tr:hover {
    background: rgba(92, 104, 132, 0.09);
    box-shadow: 0 6px 18px -16px rgba(63, 74, 97, 0.5);
    transform: translateY(-3px);
}

.table tbody tr:last-child td {
    border-bottom: none;
}

.table tbody tr.selected {
    background: rgba(90, 102, 133, 0.15);
    box-shadow: inset 3px 0 0 var(--brand-500);
}

.table-empty {
    padding: var(--space-6);
    text-align: center;
    color: var(--text-muted);
}

.table-empty i {
    font-size: 3rem;
    margin-bottom: var(--space-3);
    color: rgba(92, 104, 132, 0.25);
}

.table-pagination {
    padding: var(--space-4) var(--space-5);
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(90deg, rgba(86, 96, 123, 0.06), transparent);
}

.pagination-info {
    color: var(--text-muted);
    font-size: 0.9rem;
}

.pagination .page-link {
    border-radius: var(--radius-pill);
    border: none;
    color: var(--brand-600);
    font-weight: 500;
    padding: 0.45rem 0.9rem;
}

.pagination .page-link:hover {
    background: rgba(86, 96, 123, 0.14);
}

.pagination .page-item.active .page-link {
    background: var(--brand-600);
    color: #fff;
}

/* Badges */
.badge {
    border-radius: var(--radius-pill);
    padding: 0.35rem 0.75rem;
    font-weight: 600;
    letter-spacing: 0.02em;
}

.badge.bg-primary { background: rgba(90, 102, 133, 0.2); color: var(--brand-700); }
.badge.bg-success { background: rgba(18, 140, 98, 0.14); color: #136f52; }
.badge.bg-warning { background: rgba(210, 139, 25, 0.18); color: #855d12; }
.badge.bg-danger { background: rgba(209, 75, 75, 0.18); color: #8f3333; }
.badge.bg-secondary { background: rgba(101, 116, 146, 0.18); color: var(--brand-600); }

/* Alerts */
.alert {
    border-radius: var(--radius-lg);
    border: 1px solid transparent;
    padding: var(--space-3) var(--space-4);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    background: rgba(19, 22, 33, 0.02);
}

.alert-success {
    background: rgba(18, 140, 98, 0.14);
    border-color: rgba(18, 140, 98, 0.24);
    color: #136f52;
}

.alert-danger {
    background: rgba(209, 75, 75, 0.14);
    border-color: rgba(209, 75, 75, 0.24);
    color: #8f3333;
}

.alert-info {
    background: rgba(74, 101, 195, 0.14);
    border-color: rgba(74, 101, 195, 0.24);
    color: #324a9f;
}

.alert-warning {
    background: rgba(210, 139, 25, 0.14);
    border-color: rgba(210, 139, 25, 0.24);
    color: #855d12;
}

/* Utilities */
.shadow-sm { box-shadow: var(--shadow-sm) !important; }
.shadow-md { box-shadow: var(--shadow-md) !important; }
.shadow-lg { box-shadow: var(--shadow-lg) !important; }
.text-muted { color: var(--text-muted) !important; }
.text-neutral { color: var(--text-neutral) !important; }
.text-brand { color: var(--brand-600) !important; }
.bg-subtle { background: var(--surface-50) !important; }

/* Tables: sticky columns in RTL */
.table-responsive {
    border-radius: var(--radius-lg);
}

.table-responsive::-webkit-scrollbar {
    height: 10px;
}

.table-responsive::-webkit-scrollbar-thumb {
    background: rgba(148, 163, 184, 0.4);
    border-radius: var(--radius-pill);
}

/* Focus Visible */
:focus-visible {
    outline: 3px solid rgba(28, 167, 236, 0.4);
    outline-offset: 2px;
}

/* Empty State */
.empty-state {
    border: 1px dashed rgba(26, 31, 45, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-6);
    text-align: center;
    background: rgba(255, 255, 255, 0.9);
}

.empty-state__icon {
    width: 64px;
    height: 64px;
    border-radius: 20px;
    background: rgba(92, 104, 132, 0.12);
    color: var(--brand-600);
    display: grid;
    place-items: center;
    font-size: 1.8rem;
    margin: 0 auto var(--space-3);
}

/* Timeline / History pills */
.timeline-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--brand-600), var(--brand-500));
    box-shadow: 0 0 0 4px rgba(92, 104, 132, 0.18);
}

/* Charts placeholder */
.chart-card {
    position: relative;
    overflow: hidden;
}

.chart-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at top left, rgba(28, 167, 236, 0.12), transparent 60%);
    pointer-events: none;
}

/* Print */
@media print {
    body.sidebar-layout {
        display: block;
    }
    .sidebar,
    .topbar,
    .btn,
    .alert,
    .table-actions,
    .sidebar-overlay {
        display: none !important;
    }
    .card {
        box-shadow: none !important;
        border: 1px solid rgba(15, 23, 42, 0.1) !important;
    }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
        scroll-behavior: auto !important;
    }
}
